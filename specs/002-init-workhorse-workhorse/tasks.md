# 任务: 实现 `init` 命令

**功能**: `init` 命令
**分支**: `002-init-workhorse-workhorse`
**规格**: `specs/002-init-workhorse-workhorse/spec.md`

此文档概述了实现 `init` 命令所需的开发任务。

## 依赖顺序
1.  **设置 (Setup)**: 配置环境和依赖项。
2.  **测试 (Tests)**: 编写测试用例以验证功能（TDD 方法）。
3.  **核心 (Core)**: 实现主要功能逻辑。
4.  **集成 (Integration)**: 将新命令集成到主 CLI 应用程序中。
5.  **完善 (Polish)**: 添加文档、改进用户输出并进行最终审查。

---

- [X] **T001: [设置] 安装依赖项 [P]**
- [X] **T002: [设置] 配置测试环境 [P]**
**文件**: `jest.config.ts` (如果需要调整)
**描述**: 确保 Jest 测试环境已正确配置，以处理 TypeScript、模拟和文件系统交互。
**依赖**: 无

---

- [X] **T003: [测试] 为 `init` 命令编写单元测试**
**文件**: `tests/unit/init.test.ts`
**描述**: 创建一个测试套件来覆盖 `init` 命令的所有场景。所有测试最初都应该是失败的。
- **场景 1**: 首次成功初始化（无现有配置）。
- **场景 2**: 检测到现有配置并中止覆盖。
- **场景 3**: 检测到现有配置并确认覆盖。
- **场景 4**: 使用 `--force` 标志成功覆盖。
- **场景 5**: 因主目录权限不足而失败。
- **场景 6**: 因项目目录权限不足而失败。
- **场景 7**: 因 `.workhorse` 是文件而不是目录而失败。
**依赖**: T001, T002

---

- [X] **T004: [核心] 创建 `init` 命令文件结构**
**文件**: `src/commands/init.ts`
**描述**: 创建 `init.ts` 文件并使用 `commander` 设置基本的命令结构，包括 `--force` 选项。
**依赖**: T001

- [X] **T005: [核心] 实现文件系统和配置检查逻辑**
- [X] **T006: [核心] 实现交互式覆盖提示**
- [X] **T007: [核心] 实现初始化和错误处理逻辑**

---

- [X] **T008: [集成] 在主 CLI 中注册 `init` 命令**

---

- [X] **T009: [完善] 添加 JSDoc 文档 [P]**
- [X] **T010: [完善] 审查和最终确定用户输出 [P]**

## 并行执行指南

以下任务可以并行执行以加快开发速度:

**第一组 (设置)**:
```bash
# 终端 1
Task agent T001

# 终端 2
Task agent T002
```

**第二组 (核心开发)**:
- T003 (测试) 必须在 T004-T007 (核心实现) 之前完成。

**第三组 (完善)**:
- T009 和 T010 可以在 T008 完成后并行执行。
```bash
# 终端 1
Task agent T009

# 终端 2
Task agent T010
```
